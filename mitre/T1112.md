Title: Modify Registry

Description: Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.

Access to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility

[Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry

modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.

Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via

[Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017)

The Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin

Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication. Metadata:

ID: T1112

Related Tactics (the tactic objectives that T1112 can be used to accomplish): Defense Evasion URL: https://attack.mitre.org/techniques/T1112

Platforms (the system the adversary is operating within): Windows Procedure Examples (usage examples):

ID: C0028 | Name: 2015 Ukraine Electric Power Attack | Source Type: campaign | Mapping Type: uses | Mapping description: During the [2015 Ukraine Electric Power

Attack](https://attack.mitre.org/campaigns/C0028), [Sandworm

Team](https://attack.mitre.org/groups/G0034) modified in-registry Internet settings to lower internet security before launching 'rundll32.exe', which in-turn launches the malware and communicates with C2 servers over the Internet. (Citation: Booz Allen Hamilton). |

ID: C0002 | Name: Night Dragon | Source Type: campaign | Mapping Type: uses | Mapping description: During [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors used [zwShell](https://attack.mitre.org/software/S0350) to establish full remote control of the connected machine and manipulate the Registry.(Citation: McAfee Night Dragon) |

ID: C0006 | Name: Operation Honeybee | Source Type: campaign | Mapping Type: uses | Mapping description: During [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), the threat actors used batch files that modified registry keys.(Citation: McAfee Honeybee) |

ID: C0014 | Name: Operation Wocao | Source Type: campaign | Mapping Type: uses | Mapping description: During [Operation Wocao](https://attack.mitre.org/campaigns/C0014), the threat actors enabled Wdigest by changing the

'HKLM\SYSTEM\\ControlSet001\\Control\\SecurityProviders\\WDigest' registry value from 0 (disabled) to 1 (enabled).(Citation: FoxIT Wocao December 2019) |

ID: G0073 | Name: APT19 | Source Type: group | Mapping Type: uses | Mapping description: [APT19](https://attack.mitre.org/groups/G0073) uses a Port 22 malware variant to modify several Registry keys.(Citation: Unit 42 C0d0so0 Jan 2016) |

ID: G0050 | Name: APT32 | Source Type: group | Mapping Type: uses | Mapping description: [APT32](https://attack.mitre.org/groups/G0050)'s backdoor has modified the Windows Registry to store the backdoor's configuration. (Citation: ESET OceanLotus Mar 2019) |

ID: G0082 | Name: APT38 | Source Type: group | Mapping Type: uses | Mapping description:

[APT38](https://attack.mitre.org/groups/G0082) uses a tool called CLEANTOAD that has the capability to modify Registry keys.(Citation: FireEye APT38 Oct 2018) |

ID: G0096 | Name: APT41 | Source Type: group | Mapping Type: uses | Mapping description: [APT41](https://attack.mitre.org/groups/G0096) used a malware variant called GOODLUCK to modify the registry in order to steal credentials.(Citation: FireEye APT41 Aug 2019)(Citation: Group IB APT 41 June 2021) |

ID: G0108 | Name: Blue Mockingbird | Source Type: group | Mapping Type: uses | Mapping description: [Blue Mockingbird](https://attack.mitre.org/groups/G0108) has used Windows Registry modifications to specify a DLL payload.(Citation: RedCanary Mockingbird May 2020) |

ID: G0035 | Name: Dragonfly | Source Type: group | Mapping Type: uses | Mapping description: [Dragonfly](https://attack.mitre.org/groups/G0035) has modified the Registry to perform multiple techniques through the use of [Reg](https://attack.mitre.org/software/S0075).(Citation: US-CERT TA18-074A) |

ID: G1006 | Name: Earth Lusca | Source Type: group | Mapping Type: uses | Mapping description: [Earth Lusca](https://attack.mitre.org/groups/G1006) modified the registry using the command <code>reg add "HKEY_CURRENT_USER\Environment" /v UserInitMprLogonScript /t REG_SZ /d "[file path]"</code> for persistence.(Citation: TrendMicro EarthLusca 2022) |

ID: G1003 | Name: Ember Bear | Source Type: group | Mapping Type: uses | Mapping description: [Ember Bear](https://attack.mitre.org/groups/G1003) has used an open source batch script to modify Windows Defender registry keys.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) | ID: G0061 | Name: FIN8 | Source Type: group | Mapping Type: uses | Mapping description: [FIN8](https://attack.mitre.org/groups/G0061) has deleted Registry keys during post compromise cleanup activities.(Citation: FireEye Know Your Enemy FIN8 Aug 2016) |

ID: G0047 | Name: Gamaredon Group | Source Type: group | Mapping Type: uses | Mapping description: [Gamaredon Group](https://attack.mitre.org/groups/G0047) has removed security settings for VBA macro execution by changing registry values

<code>HKCU\Software\Microsoft\Office\&lt;version&gt;\&lt;product&gt;\Security\VBAWarnings</code> and

ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021) |

ID: G0078 | Name: Gorgon Group | Source Type: group | Mapping Type: uses | Mapping description: [Gorgon Group](https://attack.mitre.org/groups/G0078) malware can deactivate security mechanisms in Microsoft Office by editing several keys and values under <code>HKCU\Software\Microsoft\Office\</code>.(Citation: Unit 42 Gorgon Group Aug 2018) |

ID: G0094 | Name: Kimsuky | Source Type: group | Mapping Type: uses | Mapping description: [Kimsuky](https://attack.mitre.org/groups/G0094) has modified Registry settings for default file associations to enable all macros and for persistence.(Citation: CISA AA20-301A Kimsuky)(Citation: Crowdstrike GTR2020 Mar 2020)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi) |

ID: G1014 | Name: LuminousMoth | Source Type: group | Mapping Type: uses | Mapping description: [LuminousMoth](https://attack.mitre.org/groups/G1014) has used malware that adds Registry keys for persistence.(Citation: Kaspersky LuminousMoth July 2021)(Citation: Bitdefender LuminousMoth July 2021) |

ID: G0059 | Name: Magic Hound | Source Type: group | Mapping Type: uses | Mapping description: [Magic Hound](https://attack.mitre.org/groups/G0059) has modified Registry settings for security tools.(Citation: DFIR Report APT35 ProxyShell March 2022) |

ID: G0040 | Name: Patchwork | Source Type: group | Mapping Type: uses | Mapping description: A [Patchwork](https://attack.mitre.org/groups/G0040) payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.(Citation: TrendMicro Patchwork Dec 2017) | ID: G0091 | Name: Silence | Source Type: group | Mapping Type: uses | Mapping description:

[Silence](https://attack.mitre.org/groups/G0091) can create, delete, or modify a specified Registry key or value.(Citation: Group IB Silence Sept 2018) |

ID: G0092 | Name: TA505 | Source Type: group | Mapping Type: uses | Mapping description: [TA505](https://attack.mitre.org/groups/G0092) has used malware to disable Windows Defender through modification of the Registry.(Citation: Korean FSI TA505 2020) |

ID: G0027 | Name: Threat Group-3390 | Source Type: group | Mapping Type: uses | Mapping description: A [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool has created new Registry keys under 'HKEY_CURRENT_USER\Software\Classes\' and

'HKLM\SYSTEM\CurrentControlSet\services'.(Citation: Nccgroup Emissary Panda May 2018)(Citation: Trend Micro Iron Tiger April 2021) |

ID: G0010 | Name: Turla | Source Type: group | Mapping Type: uses | Mapping description: [Turla](https://attack.mitre.org/groups/G0010) has modify Registry values to store payloads.(Citation: ESET Turla PowerShell May 2019)(Citation: Symantec Waterbug Jun 2019) |

ID: G0102 | Name: Wizard Spider | Source Type: group | Mapping Type: uses | Mapping description: [Wizard Spider](https://attack.mitre.org/groups/G0102) has modified the Registry key <code>HKLM\System\CurrentControlSet\Control\SecurityProviders\WDigest</code> by setting the <code>UseLogonCredential</code> registry value to <code>1</code> in order to force credentials to be stored in clear text in memory. [Wizard Spider](https://attack.mitre.org/groups/G0102) has also modified the WDigest registry key to allow plaintext credentials to be cached in memory.(Citation: CrowdStrike Grim Spider May 2019)(Citation: Mandiant FIN12 Oct 2021) |

ID: S0677 | Name: AADInternals | Source Type: software | Mapping Type: uses | Mapping description: [AADInternals](https://attack.mitre.org/software/S0677) can modify registry keys as part of setting a new pass-through authentication agent.(Citation: AADInternals Documentation) |

ID: S0045 | Name: ADVSTORESHELL | Source Type: software | Mapping Type: uses | Mapping description: [ADVSTORESHELL](https://attack.mitre.org/software/S0045) is capable of setting and deleting Registry values.(Citation: Bitdefender APT28 Dec 2015) |

ID: S0331 | Name: Agent Tesla | Source Type: software | Mapping Type: uses | Mapping description: [Agent Tesla](https://attack.mitre.org/software/S0331) can achieve persistence by modifying Registry key entries.(Citation: SentinelLabs Agent Tesla Aug 2020) |

ID: S1025 | Name: Amadey | Source Type: software | Mapping Type: uses | Mapping description: [Amadey](https://attack.mitre.org/software/S1025) has overwritten registry keys for persistence.(Citation: BlackBerry Amadey 2020) |

ID: S0438 | Name: Attor | Source Type: software | Mapping Type: uses | Mapping description: [Attor](https://attack.mitre.org/software/S0438)'s dispatcher can modify the Run registry key.(Citation: ESET Attor Oct 2019) |

ID: S0640 | Name: Avaddon | Source Type: software | Mapping Type: uses | Mapping description: [Avaddon](https://attack.mitre.org/software/S0640) modifies several registry keys for persistence and UAC bypass.(Citation: Arxiv Avaddon Feb 2021) |

ID: S0031 | Name: BACKSPACE | Source Type: software | Mapping Type: uses | Mapping description: [BACKSPACE](https://attack.mitre.org/software/S0031) is capable of deleting Registry keys, sub-keys, and values on a victim system.(Citation: FireEye APT30) |

ID: S0245 | Name: BADCALL | Source Type: software | Mapping Type: uses | Mapping description: [BADCALL](https://attack.mitre.org/software/S0245) modifies the firewall Registry key

US-CERT BADCALL) | ID: S0239 | Name: Bankshot | Source Type: software | Mapping Type: uses | Mapping description: [Bankshot](https://attack.mitre.org/software/S0239) writes data into the Registry key <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Pniumj</code>.(Citation: US-CERT Bankshot Dec 2017) |

ID: S0268 | Name: Bisonal | Source Type: software | Mapping Type: uses | Mapping description: [Bisonal](https://attack.mitre.org/software/S0268) has deleted Registry keys to clean up its prior

activity.(Citation: Talos Bisonal Mar 2020) |

ID: S0570 | Name: BitPaymer | Source Type: software | Mapping Type: uses | Mapping description: [BitPaymer](https://attack.mitre.org/software/S0570) can set values in the Registry to help in execution.(Citation: Crowdstrike Indrik November 2018) |

ID: S1070 | Name: Black Basta | Source Type: software | Mapping Type: uses | Mapping description: [Black Basta](https://attack.mitre.org/software/S1070) can modify the Registry to enable itself to run in safe mode and to modify the icons and file extensions for encrypted files.(Citation: Minerva Labs Black Basta May 2022)(Citation: Cyble Black Basta May 2022)(Citation: Trend Micro Black Basta May 2022)(Citation: NCC Group Black Basta June 2022)(Citation: Deep Instinct Black Basta August 2022)(Citation: Palo Alto Networks Black Basta August 2022) |

ID: S1068 | Name: BlackCat | Source Type: software | Mapping Type: uses | Mapping description: [BlackCat](https://attack.mitre.org/software/S1068) has the ability to add the following registry key on compromised networks to maintain persistence:

'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services \LanmanServer\Paramenters'(Citation: Microsoft BlackCat Jun 2022) |

ID: S0023 | Name: CHOPSTICK | Source Type: software | Mapping Type: uses | Mapping description: [CHOPSTICK](https://attack.mitre.org/software/S0023) may modify Registry keys to store RC4 encrypted configuration information.(Citation: FireEye APT28) |

ID: S0527 | Name: CSPY Downloader | Source Type: software | Mapping Type: uses | Mapping description: [CSPY Downloader](https://attack.mitre.org/software/S0527) can write to the Registry under the <code>%windir%</code> variable to execute tasks.(Citation: Cybereason Kimsuky November 2020) |

ID: S0348 | Name: Cardinal RAT | Source Type: software | Mapping Type: uses | Mapping description: [Cardinal RAT](https://attack.mitre.org/software/S0348) sets <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Load</code> to point to its executable.(Citation: PaloAlto CardinalRat Apr 2017) |

ID: S0261 | Name: Catchamas | Source Type: software | Mapping Type: uses | Mapping description: [Catchamas](https://attack.mitre.org/software/S0261) creates three Registry keys to establish persistence by adding a [Windows Service](https://attack.mitre.org/techniques/T1543/003).(Citation: Symantec Catchamas April 2018) |

ID: S0572 | Name: Caterpillar WebShell | Source Type: software | Mapping Type: uses | Mapping description: [Caterpillar WebShell](https://attack.mitre.org/software/S0572) has a command to modify a Registry key.(Citation: ClearSky Lebanese Cedar Jan 2021) |

ID: S0631 | Name: Chaes | Source Type: software | Mapping Type: uses | Mapping description: [Chaes](https://attack.mitre.org/software/S0631) can modify Registry values to stored information and establish persistence.(Citation: Cybereason Chaes Nov 2020) |

ID: S0674 | Name: CharmPower | Source Type: software | Mapping Type: uses | Mapping description: [CharmPower](https://attack.mitre.org/software/S0674) can remove persistence-related artifacts from the Registry.(Citation: Check Point APT35 CharmPower January 2022) |

ID: S0660 | Name: Clambling | Source Type: software | Mapping Type: uses | Mapping description: [Clambling](https://attack.mitre.org/software/S0660) can set and delete Registry keys.(Citation: Trend Micro DRBControl February 2020) |

ID: S0611 | Name: Clop | Source Type: software | Mapping Type: uses | Mapping description: [Clop](https://attack.mitre.org/software/S0611) can make modifications to Registry keys.(Citation: Cybereason Clop Dec 2020) |

ID: S0154 | Name: Cobalt Strike | Source Type: software | Mapping Type: uses | Mapping description: [Cobalt Strike](https://attack.mitre.org/software/S0154) can modify Registry values within <code>HKEY_CURRENT_USER\Software\Microsoft\Office\<Excel

Version>\Excel\Security\AccessVBOM\</code> to enable the execution of additional code.(Citation: Talos Cobalt Strike September 2020) |

ID: S0126 | Name: ComRAT | Source Type: software | Mapping Type: uses | Mapping description:

[ComRAT](https://attack.mitre.org/software/S0126) has modified Registry values to store encrypted orchestrator code and payloads.(Citation: ESET ComRAT May 2020)(Citation: CISA ComRAT Oct 2020) |

ID: S0608 | Name: Conficker | Source Type: software | Mapping Type: uses | Mapping description: [Conficker](https://attack.mitre.org/software/S0608) adds keys to the Registry at

<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services</code> and various other Registry locations.(Citation: SANS Conficker)(Citation: Trend Micro Conficker) |

ID: S0488 | Name: CrackMapExec | Source Type: software | Mapping Type: uses | Mapping description: [CrackMapExec](https://attack.mitre.org/software/S0488) can create a registry key using wdigest.(Citation: CME Github September 2018) |

ID: S0115 | Name: Crimson | Source Type: software | Mapping Type: uses | Mapping description: [Crimson](https://attack.mitre.org/software/S0115) can set a Registry key to determine how long it has been installed and possibly to indicate the version number.(Citation: Proofpoint Operation Transparent Tribe March 2016) |

ID: S1033 | Name: DCSrv | Source Type: software | Mapping Type: uses | Mapping description: [DCSrv](https://attack.mitre.org/software/S1033) has created Registry keys for persistence.(Citation: Checkpoint MosesStaff Nov 2021) |

ID: S0334 | Name: DarkComet | Source Type: software | Mapping Type: uses | Mapping description: [DarkComet](https://attack.mitre.org/software/S0334) adds a Registry value for its installation routine to the Registry Key

<code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System Enable LUA="0"</code> and

<code>HKEY_CURRENT_USER\Software\DC3_FEXEC</code>.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) |

ID: S1066 | Name: DarkTortilla | Source Type: software | Mapping Type: uses | Mapping description: [DarkTortilla](https://attack.mitre.org/software/S1066) has modified registry keys for persistence.(Citation: Secureworks DarkTortilla Aug 2022) |

ID: S0673 | Name: DarkWatchman | Source Type: software | Mapping Type: uses | Mapping description: [DarkWatchman](https://attack.mitre.org/software/S0673) can modify Registry values to store configuration strings, keylogger, and output of components.(Citation: Prevailion DarkWatchman 2021) |

ID: S0568 | Name: EVILNUM | Source Type: software | Mapping Type: uses | Mapping description: [EVILNUM](https://attack.mitre.org/software/S0568) can make modifications to the Regsitry for persistence.(Citation: Prevailion EvilNum May 2020) |

ID: S0343 | Name: Exaramel for Windows | Source Type: software | Mapping Type: uses | Mapping description: [Exaramel for Windows](https://attack.mitre.org/software/S0343) adds the configuration to the Registry in XML format.(Citation: ESET TeleBots Oct 2018) |

ID: S0569 | Name: Explosive | Source Type: software | Mapping Type: uses | Mapping description: [Explosive](https://attack.mitre.org/software/S0569) has a function to write itself to Registry values.(Citation: CheckPoint Volatile Cedar March 2015) |

ID: S0267 | Name: FELIXROOT | Source Type: software | Mapping Type: uses | Mapping description: [FELIXROOT](https://attack.mitre.org/software/S0267) deletes the Registry key <code>HKCU\Software\Classes\Applications\rundll32.exe\shell\open</code>.(Citation: FireEye FELIXROOT July 2018) |

ID: S0679 | Name: Ferocious | Source Type: software | Mapping Type: uses | Mapping description: [Ferocious](https://attack.mitre.org/software/S0679) has the ability to add a Class ID in the current user Registry hive to enable persistence mechanisms.(Citation: Kaspersky WIRTE November 2021) |

ID: S0666 | Name: Gelsemium | Source Type: software | Mapping Type: uses | Mapping description: [Gelsemium](https://attack.mitre.org/software/S0666) can modify the Registry to store its components.(Citation: ESET Gelsemium June 2021) |

ID: S0531 | Name: Grandoreiro | Source Type: software | Mapping Type: uses | Mapping description: [Grandoreiro](https://attack.mitre.org/software/S0531) can modify the Registry to store its configuration at 'HKCU\Software\' under frequently changing names including <code>%USERNAME%</code> and <code>ToolTech-RM</code>.(Citation: ESET Grandoreiro April 2020) |

ID: S0342 | Name: GreyEnergy | Source Type: software | Mapping Type: uses | Mapping description: [GreyEnergy](https://attack.mitre.org/software/S0342) modifies conditions in the Registry and adds keys.(Citation: ESET GreyEnergy Oct 2018) |

ID: S0376 | Name: HOPLIGHT | Source Type: software | Mapping Type: uses | Mapping description: [HOPLIGHT](https://attack.mitre.org/software/S0376) has modified Managed Object Format (MOF) files within the Registry to run specific commands and create persistence on the system.(Citation: US-CERT HOPLIGHT Apr 2019) |

ID: S0697 | Name: HermeticWiper | Source Type: software | Mapping Type: uses | Mapping description: [HermeticWiper](https://attack.mitre.org/software/S0697) has the ability to modify Registry keys to disable crash dumps, colors for compressed files, and pop-up information about folders and desktop items.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Qualys Hermetic Wiper March 2022) |

ID: S0203 | Name: Hydraq | Source Type: software | Mapping Type: uses | Mapping description: [Hydraq](https://attack.mitre.org/software/S0203) creates a Registry subkey to register its created service, and can also uninstall itself later by deleting this value.

[Hydraq](https://attack.mitre.org/software/S0203)'s backdoor also enables remote attackers to modify and delete subkeys.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) |

ID: S0537 | Name: HyperStack | Source Type: software | Mapping Type: uses | Mapping description: [HyperStack](https://attack.mitre.org/software/S0537) can add the name of its communication pipe to

Accenture HyperStack October 2020) |

ID: S0260 | Name: InvisiMole | Source Type: software | Mapping Type: uses | Mapping description: [InvisiMole](https://attack.mitre.org/software/S0260) has a command to create, set, copy, or delete a specified Registry key or value.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) |

ID: S0271 | Name: KEYMARBLE | Source Type: software | Mapping Type: uses | Mapping description: [KEYMARBLE](https://attack.mitre.org/software/S0271) has a command to create Registry entries for storing data under

<code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\WABE\DataPath</code>.(Citation: US-CERT KEYMARBLE Aug 2018) |

ID: S0669 | Name: KOCTOPUS | Source Type: software | Mapping Type: uses | Mapping description: [KOCTOPUS](https://attack.mitre.org/software/S0669) has added and deleted keys from the Registry.(Citation: MalwareBytes LazyScripter Feb 2021) |

ID: S0356 | Name: KONNI | Source Type: software | Mapping Type: uses | Mapping description: [KONNI](https://attack.mitre.org/software/S0356) has modified registry keys of ComSysApp, Svchost, and xmlProv on the machine to gain persistence.(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021) |

ID: S0397 | Name: LoJax | Source Type: software | Mapping Type: uses | Mapping description: [LoJax](https://attack.mitre.org/software/S0397) has modified the Registry key <code>'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute'</code> from <code>'autocheck autochk *'</code> to <code>'autocheck autoche *'</code>.(Citation: ESET LoJax Sept 2018) |

ID: S0447 | Name: Lokibot | Source Type: software | Mapping Type: uses | Mapping description: [Lokibot](https://attack.mitre.org/software/S0447) has modified the Registry as part of its UAC

bypass process.(Citation: Talos Lokibot Jan 2021) |

ID: S1060 | Name: Mafalda | Source Type: software | Mapping Type: uses | Mapping description: [Mafalda](https://attack.mitre.org/software/S1060) can manipulate the system registry on a compromised host.(Citation: SentinelLabs Metador Technical Appendix Sept 2022) |

ID: S0576 | Name: MegaCortex | Source Type: software | Mapping Type: uses | Mapping description: [MegaCortex](https://attack.mitre.org/software/S0576) has added entries to the Registry for ransom contact information.(Citation: IBM MegaCortex) |

ID: S0455 | Name: Metamorfo | Source Type: software | Mapping Type: uses | Mapping description: [Metamorfo](https://attack.mitre.org/software/S0455) has written process names to the Registry, disabled IE browser features, deleted Registry keys, and changed the ExtendedUIHoverTime key.(Citation: Medium Metamorfo Apr 2020)(Citation: Fortinet Metamorfo Feb 2020)(Citation: FireEye Metamorfo Apr 2018)(Citation: ESET Casbaneiro Oct 2019) |

ID: S1047 | Name: Mori | Source Type: software | Mapping Type: uses | Mapping description: [Mori](https://attack.mitre.org/software/S1047) can write data to 'HKLM\Software\NFC\IPA' and 'HKLM\Software\NFC\' and delete Registry values.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: CYBERCOM Iranian Intel Cyber January 2022) |

ID: S0256 | Name: Mosquito | Source Type: software | Mapping Type: uses | Mapping description: [Mosquito](https://attack.mitre.org/software/S0256) can modify Registry keys under <code>HKCU\Software\Microsoft\[dllname]</code> to store configuration values.

[Mosquito](https://attack.mitre.org/software/S0256) also modifies Registry keys under <code>HKCR\CLSID\...\InprocServer32</code> with a path to the launcher.(Citation: ESET Turla Mosquito Jan 2018) |

ID: S0198 | Name: NETWIRE | Source Type: software | Mapping Type: uses | Mapping description: [NETWIRE](https://attack.mitre.org/software/S0198) can modify the Registry to store its configuration information.(Citation: Red Canary NETWIRE January 2020) |

ID: S0205 | Name: Naid | Source Type: software | Mapping Type: uses | Mapping description: [Naid](https://attack.mitre.org/software/S0205) creates Registry entries that store information about a created service and point to a malicious DLL dropped to disk.(Citation: Symantec Naid June 2012) |

ID: S0336 | Name: NanoCore | Source Type: software | Mapping Type: uses | Mapping description: [NanoCore](https://attack.mitre.org/software/S0336) has the capability to edit the Registry.(Citation: DigiTrust NanoCore Jan 2017)(Citation: PaloAlto NanoCore Feb 2016) |

ID: S0691 | Name: Neoichor | Source Type: software | Mapping Type: uses | Mapping description: [Neoichor](https://attack.mitre.org/software/S0691) has the ability to configure browser settings by modifying Registry entries under 'HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer'.(Citation: Microsoft NICKEL December 2021) |

ID: S0210 | Name: Nerex | Source Type: software | Mapping Type: uses | Mapping description: [Nerex](https://attack.mitre.org/software/S0210) creates a Registry subkey that registers a new service.(Citation: Symantec Nerex May 2012) |

ID: S0457 | Name: Netwalker | Source Type: software | Mapping Type: uses | Mapping description: [Netwalker](https://attack.mitre.org/software/S0457) can add the following registry entry: <code>HKEY_CURRENT_USER\SOFTWARE\{8 random characters}</code>.(Citation: TrendMicro Netwalker May 2020) |

ID: S1090 | Name: NightClub | Source Type: software | Mapping Type: uses | Mapping description: [NightClub](https://attack.mitre.org/software/S1090) can modify the Registry to set the ServiceDLL for a service created by the malware for persistence.(Citation: MoustachedBouncer ESET August 2023) |

ID: S0229 | Name: Orz | Source Type: software | Mapping Type: uses | Mapping description: [Orz](https://attack.mitre.org/software/S0229) can perform Registry operations.(Citation: Proofpoint Leviathan Oct 2017) |

ID: S0158 | Name: PHOREAL | Source Type: software | Mapping Type: uses | Mapping description:

[PHOREAL](https://attack.mitre.org/software/S0158) is capable of manipulating the Registry.(Citation: FireEye APT32 May 2017) |

ID: S0254 | Name: PLAINTEE | Source Type: software | Mapping Type: uses | Mapping description: [PLAINTEE](https://attack.mitre.org/software/S0254) uses <code>reg add</code> to add a Registry Run key for persistence.(Citation: Rancor Unit42 June 2018) |

ID: S0664 | Name: Pandora | Source Type: software | Mapping Type: uses | Mapping description: [Pandora](https://attack.mitre.org/software/S0664) can write an encrypted token to the Registry to enable processing of remote commands.(Citation: Trend Micro Iron Tiger April 2021) |

ID: S1050 | Name: PcShare | Source Type: software | Mapping Type: uses | Mapping description: [PcShare](https://attack.mitre.org/software/S1050) can delete its persistence mechanisms from the registry.(Citation: Bitdefender FunnyDream Campaign November 2020) |

ID: S0517 | Name: Pillowmint | Source Type: software | Mapping Type: uses | Mapping description: [Pillowmint](https://attack.mitre.org/software/S0517) has modified the Registry key <code>HKLM\SOFTWARE\Microsoft\DRM</code> to store a malicious payload.(Citation: Trustwave Pillowmint June 2020) |

ID: S0501 | Name: PipeMon | Source Type: software | Mapping Type: uses | Mapping description: [PipeMon](https://attack.mitre.org/software/S0501) has modified the Registry to store its encrypted payload.(Citation: ESET PipeMon May 2020) |

ID: S0013 | Name: PlugX | Source Type: software | Mapping Type: uses | Mapping description: [PlugX](https://attack.mitre.org/software/S0013) has a module to create, delete, or modify Registry keys.(Citation: CIRCL PlugX March 2013) |

ID: S0428 | Name: PoetRAT | Source Type: software | Mapping Type: uses | Mapping description: [PoetRAT](https://attack.mitre.org/software/S0428) has made registry modifications to alter its behavior upon execution.(Citation: Talos PoetRAT April 2020) |

ID: S0012 | Name: PoisonIvy | Source Type: software | Mapping Type: uses | Mapping description: [PoisonIvy](https://attack.mitre.org/software/S0012) creates a Registry subkey that registers a new system device.(Citation: Symantec Darkmoon Aug 2005) |

ID: S0518 | Name: PolyglotDuke | Source Type: software | Mapping Type: uses | Mapping description: [PolyglotDuke](https://attack.mitre.org/software/S0518) can write encrypted JSON configuration files to the Registry.(Citation: ESET Dukes October 2019) |

ID: S0441 | Name: PowerShower | Source Type: software | Mapping Type: uses | Mapping description: [PowerShower](https://attack.mitre.org/software/S0441) has added a registry key so future powershell.exe instances are spawned off-screen by default, and has removed all registry entries that are left behind during the dropper process.(Citation: Unit 42 Inception November 2018) | ID: S1058 | Name: Prestige | Source Type: software | Mapping Type: uses | Mapping description: [Prestige](https://attack.mitre.org/software/S1058) has the ability to register new registry keys for a new extension handler via 'HKCR\.enc' and 'HKCR\enc\shell\open\command'.(Citation: Microsoft Prestige ransomware October 2022) |

ID: S0583 | Name: Pysa | Source Type: software | Mapping Type: uses | Mapping description: [Pysa](https://attack.mitre.org/software/S0583) has modified the registry key "SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" and added the ransom note.(Citation: CERT-FR PYSA April 2020) |

ID: S0269 | Name: QUADAGENT | Source Type: software | Mapping Type: uses | Mapping description: [QUADAGENT](https://attack.mitre.org/software/S0269) modifies an HKCU Registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications.(Citation: Unit 42 QUADAGENT July 2018) | ID: S0650 | Name: QakBot | Source Type: software | Mapping Type: uses | Mapping description: [QakBot](https://attack.mitre.org/software/S0650) can modify the Registry to store its configuration information in a randomly named subkey under <code>HKCU\Software\Microsoft</code>.(Citation: Red Canary Qbot)(Citation: Group IB Ransomware September 2020) |

ID: S0262 | Name: QuasarRAT | Source Type: software | Mapping Type: uses | Mapping

description: [QuasarRAT](https://attack.mitre.org/software/S0262) has a command to edit the Registry on the victim's machine.(Citation: GitHub QuasarRAT)(Citation: CISA AR18-352A Quasar RAT December 2018) |

ID: S0662 | Name: RCSession | Source Type: software | Mapping Type: uses | Mapping description: [RCSession](https://attack.mitre.org/software/S0662) can write its configuration file to the Registry.(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) |

ID: S0496 | Name: REvil | Source Type: software | Mapping Type: uses | Mapping description: [REvil](https://attack.mitre.org/software/S0496) can modify the Registry to save encryption parameters and system information.(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab and REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Secureworks REvil September 2019) |

ID: S0240 | Name: ROKRAT | Source Type: software | Mapping Type: uses | Mapping description: [ROKRAT](https://attack.mitre.org/software/S0240) can modify the

'HKEY_CURRENT_USER\Software\Microsoft\Office\' registry key so it can bypass the VB object model (VBOM) on a compromised host.(Citation: Malwarebytes RokRAT VBA January 2021) | ID: S0148 | Name: RTM | Source Type: software | Mapping Type: uses | Mapping description: [RTM](https://attack.mitre.org/software/S0148) can delete all Registry entries created during its execution.(Citation: ESET RTM Feb 2017) |

ID: S0075 | Name: Reg | Source Type: software | Mapping Type: uses | Mapping description: [Reg](https://attack.mitre.org/software/S0075) may be used to interact with and modify the Windows Registry of a local or remote system at the command-line interface.(Citation: Microsoft Reg) | ID: S0511 | Name: RegDuke | Source Type: software | Mapping Type: uses | Mapping description: [RegDuke](https://attack.mitre.org/software/S0511) can create seemingly legitimate Registry key to store its encryption key.(Citation: ESET Dukes October 2019) |

ID: S0019 | Name: Regin | Source Type: software | Mapping Type: uses | Mapping description: [Regin](https://attack.mitre.org/software/S0019) appears to have functionality to modify remote Registry information.(Citation: Kaspersky Regin) |

ID: S0332 | Name: Remcos | Source Type: software | Mapping Type: uses | Mapping description: [Remcos](https://attack.mitre.org/software/S0332) has full control of the Registry, including the ability to modify it.(Citation: Riskiq Remcos Jan 2018) |

ID: S0090 | Name: Rover | Source Type: software | Mapping Type: uses | Mapping description: [Rover](https://attack.mitre.org/software/S0090) has functionality to remove Registry Run key persistence as a cleanup procedure.(Citation: Palo Alto Rover) |

ID: S0692 | Name: SILENTTRINITY | Source Type: software | Mapping Type: uses | Mapping description: [SILENTTRINITY](https://attack.mitre.org/software/S0692) can modify registry keys, including to enable or disable Remote Desktop Protocol (RDP).(Citation: GitHub SILENTTRINITY Modules July 2019) |

ID: S0533 | Name: SLOTHFULMEDIA | Source Type: software | Mapping Type: uses | Mapping description: [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) can add, modify, and/or delete registry keys. It has changed the proxy configuration of a victim system by modifying the <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap</code> registry.(Citation: CISA MAR SLOTHFULMEDIA October 2020) |

ID: S0649 | Name: SMOKEDHAM | Source Type: software | Mapping Type: uses | Mapping description: [SMOKEDHAM](https://attack.mitre.org/software/S0649) has modified registry keys for persistence, to enable credential caching for credential access, and to facilitate lateral movement via RDP.(Citation: FireEye SMOKEDHAM June 2021) |

ID: S0157 | Name: SOUNDBITE | Source Type: software | Mapping Type: uses | Mapping description: [SOUNDBITE](https://attack.mitre.org/software/S0157) is capable of modifying the Registry.(Citation: FireEye APT32 May 2017) |

ID: S0559 | Name: SUNBURST | Source Type: software | Mapping Type: uses | Mapping

description: [SUNBURST](https://attack.mitre.org/software/S0559) had commands that allow an attacker to write or delete registry keys, and was observed stopping services by setting their <code>HKLM\SYSTEM\CurrentControlSet\services\\[service_name]\\Start</code> registry entries to value 4.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Microsoft Analyzing Solorigate Dec 2020) It also deleted previously-created Image File Execution Options (IFEO) Debugger registry values and registry keys related to HTTP proxy to clean up traces of its activity.(Citation: Microsoft Deep Dive Solorigate January 2021) |

ID: S0596 | Name: ShadowPad | Source Type: software | Mapping Type: uses | Mapping description: [ShadowPad](https://attack.mitre.org/software/S0596) can modify the Registry to store and maintain a configuration block and virtual file system.(Citation: Kaspersky ShadowPad Aug 2017)(Citation: TrendMicro EarthLusca 2022) |

ID: S0140 | Name: Shamoon | Source Type: software | Mapping Type: uses | Mapping description: Once [Shamoon](https://attack.mitre.org/software/S0140) has access to a network share, it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting to 1.(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation:

McAfee Shamoon December 2018) |

ID: S0444 | Name: ShimRat | Source Type: software | Mapping Type: uses | Mapping description: [ShimRat](https://attack.mitre.org/software/S0444) has registered two registry keys for shim databases.(Citation: FOX-IT May 2016 Mofang) |

ID: S0589 | Name: Sibot | Source Type: software | Mapping Type: uses | Mapping description: [Sibot](https://attack.mitre.org/software/S0589) has modified the Registry to install a second-stage script in the

<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\sibot</code>.(Citation: MSTIC NOBELIUM Mar 2021) |

ID: S0142 | Name: StreamEx | Source Type: software | Mapping Type: uses | Mapping description: [StreamEx](https://attack.mitre.org/software/S0142) has the ability to modify the Registry.(Citation: Cylance Shell Crew Feb 2017) |

ID: S0603 | Name: Stuxnet | Source Type: software | Mapping Type: uses | Mapping description: [Stuxnet](https://attack.mitre.org/software/S0603) can create registry keys to load driver files.(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011) |

ID: S0242 | Name: SynAck | Source Type: software | Mapping Type: uses | Mapping description: [SynAck](https://attack.mitre.org/software/S0242) can manipulate Registry keys.(Citation: SecureList SynAck Doppelgänging May 2018) |

ID: S0663 | Name: SysUpdate | Source Type: software | Mapping Type: uses | Mapping description: [SysUpdate](https://attack.mitre.org/software/S0663) can write its configuration file to <code>Software\Classes\scConfig</code> in either <code>HKEY_LOCAL_MACHINE</code> or <code>HKEY_CURRENT_USER</code>.(Citation: Trend Micro Iron Tiger April 2021) |

ID: S0560 | Name: TEARDROP | Source Type: software | Mapping Type: uses | Mapping description: [TEARDROP](https://attack.mitre.org/software/S0560) modified the Registry to create a Windows service for itself on a compromised host.(Citation: Check Point Sunburst Teardrop December 2020) |

ID: S0263 | Name: TYPEFRAME | Source Type: software | Mapping Type: uses | Mapping description: [TYPEFRAME](https://attack.mitre.org/software/S0263) can install encrypted configuration data under the Registry key

and

US-CERT TYPEFRAME June 2018) |

ID: S0011 | Name: Taidoor | Source Type: software | Mapping Type: uses | Mapping description:

[Taidoor](https://attack.mitre.org/software/S0011) has the ability to modify the Registry on compromised hosts using <code>RegDeleteValueA</code> and

<code>RegCreateKeyExA</code>.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) | ID: S0467 | Name: TajMahal | Source Type: software | Mapping Type: uses | Mapping description: [TajMahal](https://attack.mitre.org/software/S0467) can set the <code>KeepPrintedJobs</code> attribute for configured printers in <code>SOFTWARE\\Microsoft\\Windows

NT\\CurrentVersion\\Print\\Printers</code> to enable document stealing.(Citation: Kaspersky TajMahal April 2019) |

ID: S1011 | Name: Tarrask | Source Type: software | Mapping Type: uses | Mapping description: [Tarrask](https://attack.mitre.org/software/S1011) is able to delete the Security Descriptor ('SD') registry subkey in order to "hide" scheduled tasks.(Citation: Tarrask scheduled task) |

ID: S0665 | Name: ThreatNeedle | Source Type: software | Mapping Type: uses | Mapping description: [ThreatNeedle](https://attack.mitre.org/software/S0665) can modify the Registry to save its configuration data as the following RC4-encrypted Registry key:

'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\GameCon'.(Citation: Kaspersky ThreatNeedle Feb 2021) |

ID: S0668 | Name: TinyTurla | Source Type: software | Mapping Type: uses | Mapping description: [TinyTurla](https://attack.mitre.org/software/S0668) can set its configuration parameters in the Registry.(Citation: Talos TinyTurla September 2021) |

ID: S0266 | Name: TrickBot | Source Type: software | Mapping Type: uses | Mapping description: [TrickBot](https://attack.mitre.org/software/S0266) can modify registry entries.(Citation: Trend Micro Trickbot Nov 2018) |

ID: S0022 | Name: Uroburos | Source Type: software | Mapping Type: uses | Mapping description: [Uroburos](https://attack.mitre.org/software/S0022) can store configuration information in the Registry including the initialization vector and AES key needed to find and decrypt other [Uroburos](https://attack.mitre.org/software/S0022) components.(Citation: Joint Cybersecurity Advisory AA23-129A Snake Malware May 2023) |

ID: S0386 | Name: Ursnif | Source Type: software | Mapping Type: uses | Mapping description: [Ursnif](https://attack.mitre.org/software/S0386) has used Registry modifications as part of its installation routine.(Citation: TrendMicro BKDR_URSNIF.SM)(Citation: ProofPoint Ursnif Aug 2016) |

ID: S0476 | Name: Valak | Source Type: software | Mapping Type: uses | Mapping description: [Valak](https://attack.mitre.org/software/S0476) has the ability to modify the Registry key <code>HKCU\Software\ApplicationContainer\Appsw64</code> to store information regarding the C2 server and downloads.(Citation: Cybereason Valak May 2020)(Citation: Unit 42 Valak July 2020)(Citation: SentinelOne Valak June 2020) |

ID: S0180 | Name: Volgmer | Source Type: software | Mapping Type: uses | Mapping description: [Volgmer](https://attack.mitre.org/software/S0180) modifies the Registry to store an encoded configuration file in

<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Security</code>.(Citation: US-CERT Volgmer 2 Nov 2017)(Citation: Symantec Volgmer Aug 2014) |

ID: S0670 | Name: WarzoneRAT | Source Type: software | Mapping Type: uses | Mapping description: [WarzoneRAT](https://attack.mitre.org/software/S0670) can create

'HKCU\Software\Classes\Folder\shell\open\command' as a new registry key during privilege escalation.(Citation: Uptycs Warzone UAC Bypass November 2020)(Citation: Check Point Warzone Feb 2020) |

ID: S0612 | Name: WastedLocker | Source Type: software | Mapping Type: uses | Mapping description: [WastedLocker](https://attack.mitre.org/software/S0612) can modify registry values within the <code>Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap</code> registry key.(Citation: NCC Group WastedLocker June 2020) |

[Waterbear](https://attack.mitre.org/software/S0579) has deleted certain values from the Registry to load a malicious DLL.(Citation: Trend Micro Waterbear December 2019) |

ID: S0330 | Name: Zeus Panda | Source Type: software | Mapping Type: uses | Mapping description: [Zeus Panda](https://attack.mitre.org/software/S0330) modifies several Registry keys under <code>HKCU\Software\Microsoft\Internet Explorer\ PhishingFilter\</code> to disable phishing filters.(Citation: GDATA Zeus Panda June 2017) |

ID: S0412 | Name: ZxShell | Source Type: software | Mapping Type: uses | Mapping description: [ZxShell](https://attack.mitre.org/software/S0412) can create Registry entries to enable services to run.(Citation: Talos ZxShell Oct 2014) |

ID: S0032 | Name: gh0st RAT | Source Type: software | Mapping Type: uses | Mapping description: [gh0st RAT](https://attack.mitre.org/software/S0032) has altered the InstallTime subkey.(Citation: Gh0stRAT ATT March 2019) |

ID: S1059 | Name: metaMain | Source Type: software | Mapping Type: uses | Mapping description: [metaMain](https://attack.mitre.org/software/S1059) can write the process ID of a target process into the 'HKEY_LOCAL_MACHINE\SOFTWARE\DDE pid' Registry value as part of its reflective loading activity.(Citation: SentinelLabs Metador Technical Appendix Sept 2022) |

ID: S0385 | Name: njRAT | Source Type: software | Mapping Type: uses | Mapping description: [njRAT](https://attack.mitre.org/software/S0385) can create, delete, or modify a specified Registry key or value.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018) |

ID: S0350 | Name: zwShell | Source Type: software | Mapping Type: uses | Mapping description: [zwShell](https://attack.mitre.org/software/S0350) can modify the Registry.(Citation: McAfee Night Dragon) |

Mitigations:

Mitigation ID: M1024 | Mitigation name: Restrict Registry Permissions | Description: Restrict the ability to modify certain hives or keys in the Windows Registry. | Detection:

Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods). (Citation: Microsoft 4657 APR 2017) Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.

Monitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. The Registry may also be modified through Windows system management tools such as [Windows Management

Instrumentation](https://attack.mitre.org/techniques/T1047) and

[PowerShell](https://attack.mitre.org/techniques/T1059/001), which may require additional logging features to be configured in the operating system to collect necessary information for analysis. Monitor for processes, command-line arguments, and API calls associated with concealing Registry keys, such as Reghide. (Citation: Microsoft Reghide NOV 2006) Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns (Citation: SpectorOps Hiding Reg Jul 2017) and RegDelNull (Citation: Microsoft RegDelNull July 2016).